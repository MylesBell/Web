angular.module("myApp","ngRoute gameJoinView gameView headerBarInfoView playerCreationView tutorialView btford.socket-io LocalStorageModule UserServiceModule GameInfoServiceModule config ngIdle toastr".split(" ")).config(["$routeProvider","IdleProvider","KeepaliveProvider","TitleProvider","toastrConfig",function(a,c,e,d,k){c.idle(5);c.timeout(600);e.interval(2);d.enabled(!1);a.when("/game",{templateUrl:"views/game/game.html",controller:"GameCtrl"}).when("/join",{templateUrl:"views/gameJoin/gameJoin.html",
controller:"GameJoinCtrl"}).when("/lobby",{templateUrl:"views/lobby/lobby.html",controller:"LobbyCtrl"}).when("/tutorial",{templateUrl:"views/tutorials/tutorial.html",controller:"TutorialCtrl"}).when("/stats",{templateUrl:"views/stats/stats.html",controller:"StatsCtrl"}).when("/",{templateUrl:"views/playerCreation/playerCreation.html",controller:"PlayerCreationCtrl"}).otherwise({redirectTo:"/"});angular.extend(k,{allowHtml:!1,closeButton:!0,closeHtml:"<button>&times;</button>",extendedTimeOut:1E3,
iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},messageClass:"toast-message",onHidden:null,onShown:null,onTap:null,progressBar:!0,tapToDismiss:!0,templates:{toast:"directives/toast/toast.html",progressbar:"directives/progressbar/progressbar.html"},timeOut:4E3,titleClass:"toast-title",toastClass:"toast"})}]).run(["Idle",function(a){a.watch()}]);angular.module("config",[]).constant("ENV",{name:"production",socketIOEndpoint:"http://headgearsofwar.com:1337",skipCode:!0});angular.module("playerCreationView",["ngRoute"]).controller("PlayerCreationCtrl",["$scope","UserService","LocationService","GameInfoService","ClassService",function(a,c,e,d,k){a.username="";a.validname=!1;a.started=!1;var b=!0,f=!0;a.currentClassSelected=0;a.currentClass="";a.titleTranslate=60;a.nameFormTranslate=100;a.chooseTranslate=200;a.headerFontSize=50;a.classTranslate=0;k.getClasses().then(function(b){a.classes=b;a.currentClass=a.classes[0].name});a.start=function(){a.started=!0;a.titleTranslate=
20;a.headerFontSize=40;a.nameFormTranslate=0;a.chooseTranslate=100};a.setName=function(){b&&(b=!1,a.validname&&(a.nameFormTranslate=-100,a.chooseTranslate=0))};a.checkName=function(){""===a.username?(console.log("Please enter a name"),a.validname=!1):20<a.username.length?(console.log("Please use a shorter name"),a.validname=!1):a.validname=!0};a.nextClass=function(){3>a.currentClassSelected&&(a.classTranslate-=25,a.currentClassSelected+=1,a.currentClass=a.classes[a.currentClassSelected].name)};a.prevClass=
function(){0<a.currentClassSelected&&(a.classTranslate+=25,--a.currentClassSelected,a.currentClass=a.classes[a.currentClassSelected].name)};a.deploy=function(){f&&(f=!1,c.registerUserWithServer(a.username,a.currentClassSelected).then(function(a){e.setPath(a.path)})["catch"](function(a){console.log(a);alert(a.message);f=!0}))}}]);angular.module("gameView",["ngRoute"]).controller("GameCtrl",["$scope","NetworkService","UserService","$interval","SpecialPowerManagerService","$rootScope","toastr","GameInfoService","LocationService",function(a,c,e,d,k,b,f,m,l){function r(b){b=Number(b.substring(b.length-1,b.length));a.specialPowers[b].enabled&&(a.specialPowers[b].enabled=!1,a.$apply(),k.specialButtonUsed(a.specialPowers[b],b))}function u(a){void 0!==window.navigator.vibrate&&window.navigator.vibrate(100)}function v(){var b=e.getTeamColor();
document.getElementById("main-container");var c=document.getElementById("stats-container"),f=document.getElementById("game-container");c.style.backgroundColor=b.dark;"blue-team"===a.teamClass?(a.teamClassCSS="blue-team",f.style.backgroundImage='url("/resources/images/backgrounds/blue_game_back.jpg")'):(a.teamClassCSS="red-team",f.style.backgroundImage='url("/resources/images/backgrounds/red_game_back.jpg")');f.style.height="100%";f.style.top="0px";b=e.getHeroClass();a.classImageUrl=0===b?"/resources/images/hats/hunter_circle_small.png":
1===b?"/resources/images/hats/hitman_circle_small.png":2===b?"/resources/images/hats/healer_circle_small.png":"/resources/images/hats/hardhat_circle_small.png"}function p(){0>=a.timeToRespawn?(d.cancel(g),console.log("respawn timer is done")):--a.timeToRespawn}a.teamClass=e.getUserTeam();a.teamClassCSS="blue-team";a.nearBase=!1;a.playerDead=!1;a.playerLevel=1;a.timeToRespawn=10;a.gameOver=!1;a.winner="";a.winnerTeam="";a.specialPowers=e.getSpecialPowers();a.playerLane=e.getLane();a.classImageUrl=
"";var g,n=a.timeToRespawn;document.getElementById("switch-button");m=document.getElementById("main-container");window.oncontextmenu=function(a){console.log("Prevented long press");a.preventDefault();a.stopPropagation();return!1};v();c.registerListener({eventName:"gamePlayerDied",call:function(b){a.teamClassCSS="dead-team";a.playerDead=!0;a.timeToRespawn=n;u(1E3);g=d(p,1E3)}});c.registerListener({eventName:"gamePlayerRespawn",call:function(b){console.log("Player respawned on the server");a.timeToRespawn=
"Now";a.playerDead=!1;u(1E3);v()}});c.registerListener({eventName:"gameStateUpdate",call:function(b){2===b.state?(a.gameOver=!0,a.winnerTeam=0===b.winner?"VIKINGS":"COWBOYS","red-team"===a.teamClass?0===b.winner?(a.winner=!0,a.wonOrLost="Won!"):(a.winner=!1,a.wonOrLost="Lost!"):0===b.winner?(a.winner=!1,a.wonOrLost="Lost!"):(a.winner=!0,a.wonOrLost="Won!")):1===b.state&&(a.gameOver=!1)}});c.registerListener({eventName:"gamePlayerChangeHealth",call:function(a){u(100)}});c.registerListener({eventName:"gamePlayerLevelUp",
call:function(b){console.log("Player leveled up"+b.level);a.playerLevel=b.level;f.success("LEVEL UP!")}});c.registerListener({eventName:"gamePlayerSwitchLane",call:function(b){console.log("lane switch");a.playerLane=b.lane}});m.addEventListener("touchstart",function(a){a.preventDefault();for(var f=0;f<a.touches.length;f++){var c=a.touches[f],c=document.elementFromPoint(c.clientX,c.clientY).id;"joystick-canvas"===c?b.$emit("canvas.touch.start",a):-1<c.indexOf("special")?r(c):"stats-button"===c&&l.setPath("/stats")}});
a.useSpecial=function(a){r(a.id.toString())};a.viewStats=function(){console.log("sats");l.setPath("/stats")}}]);angular.module("gameView").controller("JoystickController",["$scope","InputHandlerService","NetworkService","UserService","$rootScope",function(a,c,e,d,k){function b(a){G=Math.PI/180*(1-a.playerHealth/a.maxHealth)*180+.002;179<G&&(G=179);v()}function f(a){t=Math.PI/180*(1-a.currentBaseHealth/a.maxBaseHealth)*180+.002;179<t&&(t=179);v()}function m(){p.style.width="100%";p.style.height="100%";p.width=p.offsetWidth;p.height=p.offsetHeight;n=Math.floor(p.width/2);h=Math.floor(p.height/2);w=.85*n;w>p.height/
2&&(console.log("canvas too big, resizing"),w=p.height/2-q/2);v()}function l(a){var b,c;if("touchmove"===a.type||"touchstart"===a.type){var f=p.getBoundingClientRect();b=a.touches[0].clientX-f.left;c=a.touches[0].clientY-f.top}else f=p.getBoundingClientRect(),b=a.clientX-f.left,c=a.clientY-f.top;a=b-q;f=c-q;b=Math.sqrt(Math.pow(b-n,2)+Math.pow(c-h,2));y.distToOrigin=b;b>w||(y.x=a,y.y=f,y.down=!0)}function r(){p.removeEventListener("mousemove",l);p.removeEventListener("touchmove",l);H=!1;y.down=!1;
window.cancelAnimationFrame(A)}function u(){v();H&&requestAnimationFrame(u)}function v(){g.clearRect(0,0,p.width,p.height);var b=Math.atan2(y.y+q-h,y.x+q-n);0>b&&(b=Math.PI- -1*b+Math.PI);b>337.5*Math.PI/180&&(b=-22.5*Math.PI/180);for(var f=Math.PI/180*45,c=Math.PI/180*-22.5,e=c+Math.PI/180*45,d=-1,l=0;8>l;l++)b>=c&&b<=e&&y.distToOrigin>z&&y.down?(g.fillStyle="#ECECEC",g.strokeStyle="#ECECEC",d=l):(g.fillStyle="white",g.strokeStyle="white"),g.lineWidth=1,g.beginPath(),g.moveTo(n,h),g.arc(n,h,w,c,
e),g.moveTo(n,h),g.closePath(),g.stroke(),g.fill(),c=e%(2*Math.PI),e+=f;b=B;b!==d&&(b!==d&&-1!==d?(b=d,a.inputButtonClicked(b)):b!==d&&-1===d&&(b=d,a.inputButtonClicked(b),x.style.backgroundPositionX="0%",x.style.backgroundPositionY="0%"));B=b;g.fillStyle="white";g.strokeStyle="white";g.lineWidth=1;g.beginPath(0);g.arc(n,h,z,0,2*Math.PI);g.closePath();g.fill();g.stroke();g.lineWidth=1;f=G+D;d=t+D;3.13<f&&(f=3.14);3.13<d&&(d=3.14);b=1.5*Math.PI+f;f=1.5*Math.PI-f;g.fillStyle=C.health.player.remaining;
g.strokeStyle=C.health.player.remaining;g.lineWidth=10;g.beginPath();g.arc(n,h,Math.floor(.85*w),f,b,!0);g.stroke();b=1.5*Math.PI+d;f=1.5*Math.PI-d;g.strokeStyle=C.health.base.remaining;g.fillStyle=C.health.base.remaining;g.beginPath();g.arc(n,h,Math.floor(.65*w),f,b,!0);g.stroke();g.drawImage(J,Math.floor(n-K/2),Math.floor(h-.86*w-K/2));g.drawImage(F,Math.floor(n-I/2),Math.floor(h-.65*w-I/2));g.fillStyle=E;g.strokeStyle=E;g.lineWidth=0;y.down?(g.beginPath(),g.arc(y.x+q,y.y+q,q,0,2*Math.PI,!0)):(g.beginPath(),
g.arc(n,h,q,0,2*Math.PI,!0));g.stroke();g.fill()}a.inputButtonClicked=function(a){c.handleInput({direction:a})["catch"](function(a){})};e.registerListener({eventName:"gamePlayerChangeHealth",call:b});e.registerListener({eventName:"gamePlayerRespawn",call:function(a){console.log("Player respawned on the server");b({playerHealth:1E3,maxHealth:1E3})}});e.registerListener({eventName:"gameBaseChangeHealth",call:f});e.registerListener({eventName:"gameStateUpdate",call:function(a){2===a.state&&f({currentBaseHealth:1,
maxBaseHealth:1})}});var p=document.getElementById("joystick-canvas"),g=p.getContext("2d"),n,h,q=30,w,z=40,B=-1,A,H=!1,G=1E-4,t=1E-4,x=document.getElementById("game-container"),C=d.getTeamColor(),E=C.dark,D=.2,F=new Image,I=25,J=new Image,K=30;console.log(d.getUserTeam());"red-team"===d.getUserTeam()?F.src="/resources/images/base_health_icon_red.png":F.src="/resources/images/base_health_icon_blue.png";F.onload=function(){m()};J.src="/resources/images/user_health_icon.png";J.onload=function(){m()};
var y={width:2*q,height:2*q,x:n-q,y:h-q,distToCenter:0,down:!1};m();k.$on("canvas.touch.start",function(a,b){H=!0;l(b);p.addEventListener("touchmove",l);A=window.requestAnimationFrame(u)});p.addEventListener("mouseup",function(a){r()});p.addEventListener("touchend",function(a){r()});window.addEventListener("resize",m);f({currentBaseHealth:1,maxBaseHealth:1})}]);angular.module("gameJoinView",["ngRoute"]).controller("GameJoinCtrl",["$scope","UserService","LocationService","NetworkService","GameInfoService",function(a,c,e,d,k){a.username=c.getUsername();a.gamecode="";a.enableInput=!0;a.joinGame=function(){var b=a.gamecode.toLowerCase();c.attemptToJoinGame(b).then(function(a){console.log(a);0===a.state||1===a.state?e.setPath("/tutorial"):console.log("Son you fucked up")})["catch"](function(b){console.log(b);a.gamecode=b.message;a.enableInput=!0});a.gamecode=
"Joining game...";a.enableInput=!1}}]);angular.module("myApp").controller("LobbyCtrl",["$scope","$rootScope","UserService","LocationService","GameInfoService","NetworkService",function(a,c,e,d,k,b){function f(b){1===b.state&&(a.canJoin=!0,a.buttonText="CLICK TO JOIN GAME")}function m(b){a.players=b.playerList}a.players=k.getPlayerList();a.showStartButton=!0;a.canJoin=!1;a.buttonText="NOT STARTED YET";document.getElementById("lobby-footer").addEventListener("click",function(){var a=document.getElementById("main-container");a.requestFullscreen?
a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()});a.getHeroClassName=function(a){return 0===a?"HUNTER":1===a?"HITMAN":2===a?"HEALER":"HARDHAT"};a.startGame=function(){a.canJoin||1===e.getGameState()?d.setPath("/game"):console.error("Tried joining game but game state wasn't 1 but "+e.getGameState())};if(1===e.getGameState()||1===k.getGameState())a.showStartButton=!0,a.canJoin=
!0,a.buttonText="CLICK TO JOIN GAME";c.$on("gameStateUpdate",function(a,b){f(b)});b.registerListener({eventName:"gamePlayerJoined",call:m});b.registerListener({eventName:"gamePlayerLeft",call:m});b.registerListener({eventName:"gameStateUpdate",call:f})}]);angular.module("tutorialView",["ngRoute"]).controller("TutorialCtrl",["$scope","ENV","UserService","LocationService","TutorialService","GameInfoService",function(a,c,e,d,k,b){function f(){0===a.currentTutorialIndex?a.prevText=m?"SKIP":"":a.currentTutorialIndex===a.tutorialSteps-1?a.nextText="LOBBY":(a.prevText="PREV",a.nextText="NEXT")}a.tutorialSteps=0;a.currentTutorialIndex=0;a.nextText="NEXT";a.prevText="";a.xTranslate=0;(function(){var a=e.getTeamColor(),b=document.getElementById("tutorial-controls");
b.style.backgroundColor=a.dark;"red-team"===e.getUserTeam()?b.style.backgroundImage="url('../resources/images/backgrounds/red_tut_polybackground.jpg')":b.style.backgroundImage="url('../resources/images/backgrounds/blue_tut_polybackground.jpg')"})();var m=!1;"development"===c.name&&(m=!0,a.prevText="SKIP");a.tutorials=k.makeTutorial(e.getHeroClass(),e.getUserTeam(),e.getSpecialPowers());document.getElementById("tutorial-sliding-container").addEventListener("touchstart",function(a){a.preventDefault()});
a.tutorialSteps=a.tutorials.length;var l=100/a.tutorialSteps;a.getStyle=function(a){return{background_image:"linear-gradient(to bottom, rgba(255,255,255,0) 50%,rgba(0,0,0,0.6) 100%), url('"+a.tutorialImage.image+"')",background_position_x:a.tutorialImage.offset_x}};a.next=function(){a.currentTutorialIndex<a.tutorialSteps-1?(a.xTranslate-=l,a.currentTutorialIndex+=1):d.setPath("/lobby");f()};a.prev=function(){0<a.currentTutorialIndex?(a.xTranslate+=l,--a.currentTutorialIndex):m&&d.setPath("/lobby");
f()}}]);angular.module("headerBarInfoView",["ngRoute"]).controller("headerBarInfoCtrl",["$scope","UserService","LocationService","NetworkService",function(a,c,e,d){a.username=c.getUsername();a.teamClass=c.getUserTeam();a.hideHeader=!1;a.$on("$routeChangeStart",function(e,b){a.username=c.getUsername()});d.registerListener({eventName:"gamePlayerJoined",call:function(){a.hideHeader=!0}});if("/"===e.getPath()||"/join"===e.getPath())a.hideHeader=!1;if("/tutorial"===e.getPath()||"/lobby"===e.getPath()||"/game"===
e.getPath())a.hideHeader=!0}]);angular.module("myApp").factory("socket",["socketFactory","ENV",function(a,c){var e=io.connect(c.socketIOEndpoint);return mySocket=a({ioSocket:e})}]);angular.module("myApp").service("NetworkService",["$q","socket","StorageService","$rootScope","Idle",function(a,c,e,d,k){function b(a,b){listenerEventList.forEach(function(c){c.eventName===a&&(c=c.call,c(b))},this);d.$emit(a,b)}d.events=[];d.$on("IdleStart",function(){console.log("Player is now idle")});d.$on("IdleWarn",function(a,b){});d.$on("IdleTimeout",function(){c.disconnect();d.$apply(function(){b("locationChange","/")});k.watch()});d.$on("IdleStart",function(){console.log("Player is now idle")});
d.$on("IdleWarn",function(a,b){});d.$on("IdleTimeout",function(){c.disconnect();d.$apply(function(){b("locationChange","/")});k.watch()});listenerEventList=[];c.on("connect",function(a){c.emit("subscribe",{name:"mobile",existingID:0})});c.on("locationChange",function(a){b("locationChange",a)});c.on("gameStateUpdate",function(a){b("gameStateUpdate",a)});c.on("gamePlayerJoined",function(a){b("gamePlayerJoined",a)});c.on("gamePlayerLeft",function(a){b("gamePlayerLeft",a)});c.on("gamePlayerNearBase",
function(a){b("gamePlayerNearBase",a)});c.on("gamePlayerChangeHealth",function(a){b("gamePlayerChangeHealth",a)});c.on("gamePlayerDied",function(a){b("gamePlayerDied",a)});c.on("gamePlayerRespawn",function(a){b("gamePlayerRespawn",a)});c.on("gameBaseChangeHealth",function(a){b("gameBaseChangeHealth",a)});c.on("gamePlayerLevelUp",function(a){b("gamePlayerLevelUp",a)});c.on("gamePlayerSwitchLane",function(a){b("gamePlayerSwitchLane",a)});c.on("gamePlayersStats",function(a){b("gamePlayersStats",a)});
return{send:function(b,e){var d=a.defer();c.emit(b,e,function(a){a.ok?d.resolve(a):d.reject(a)});return d.promise},registerListener:function(a){listenerEventList.push(a)},alertListeners:b}}]);angular.module("myApp").factory("StorageService",["$q","localStorageService",function(a,c){return{put:function(a,d){c.set(a,d)},get:function(a){c.get(a)}}}]).config(["localStorageServiceProvider",function(a){a.setPrefix("rushmore").setStorageType("sessionStorage").setNotify(!0,!0)}]);angular.module("GameInfoServiceModule",[]).factory("GameInfoService",["$q","NetworkService",function(a,c){var e=[],d=0,k;c.registerListener({eventName:"gamePlayerJoined",call:function(a){e=a.playerList}});c.registerListener({eventName:"gamePlayerLeft",call:function(a){e=a.playerList}});c.registerListener({eventName:"gameStateUpdate",call:function(a){d=a.state}});c.registerListener({eventName:"gamePlayersStats",call:function(a){k=a.playersStats;console.log(a)}});return{getPlayerList:function(){return e},
getGameState:function(){return d},getStats:function(){return k?(k.forEach(function(a){var c="/resources/images/stats/herotypes/",c=0===a.teamID?c+"viking_":c+"cowboy_",c=0===a.heroClass?c+"hunter.png":1===a.heroClass?c+"hitman.png":2===a.heroClass?c+"healer.png":c+"hardhat.png";a.image=c}),k):[{playerID:0,username:"Mike",deaths:4,gruntKills:3,heroKills:1,towersCaptured:1,heroClass:0,teamID:1,image:" /resources/images/stats/herotypes/viking_hunter.png"},{playerID:1,username:"Dave",deaths:3,gruntKills:6,
heroKills:4,towersCaptured:1,heroClass:0,teamID:1,image:" /resources/images/stats/herotypes/cowboy_hitman.png"},{playerID:2,username:"Madjid",deaths:0,gruntKills:5,heroKills:2,towersCaptured:2,heroClass:0,teamID:1,image:" /resources/images/stats/herotypes/viking_healer.png"}]}}}]);angular.module("myApp").factory("SpecialPowerManagerService",["$q","$interval","InputHandlerService",function(a,c,e){return{specialButtonUsed:function(d,k){var b;b=a.defer();console.log(d);void 0!==window.navigator.vibrate&&window.navigator.vibrate(200);e.handleSpecial(k);var f=c(function(){c.cancel(f);d.enabled=!0;b.resolve(d)},1E3*d.cooldownTime);return b.promise},setupSpecials:function(a){for(var c=0;c<a.length;c++)a[c].enabled=!0,a[c].cssName="special-"+a[c].type+"-"+a[c].idea;return a}}}]);angular.module("myApp").factory("ColorService",function(){var a={dark:"#3A539B",primary:"#446CB3",highlight:"#59ABE3",light:"#C5EFF7",health:{player:{remaining:"#87D37C",lost:"#90C695"},base:{lost:"#C5EFF7",remaining:"#59ABE3"}}},c={dark:"#96281B",primary:"#D91E18",highlight:"#E74C3C",health:{player:{remaining:"#87D37C",lost:"#90C695"},base:{lost:"#C5EFF7",remaining:"#E74C3C"}}};return{getRedColors:function(){return c},getBlueColors:function(){return a}}});angular.module("myApp").factory("InputHandlerService",["$q","NetworkService",function(a,c){return{handleInput:function(e){var d=a.defer(),k="",k="switch"===e.direction?"playerSwitchBase":"special"===e.direction?"playerSpecial":"playerDirection";c.send(k,{input:e.direction});d.resolve({ok:!0,direction:e.direction});return d.promise},handleSpecial:function(a){c.send("playerSpecial",{input:"special",specialUsedIndex:a})}}}]);angular.module("myApp").factory("LocationService",["$q","$rootScope","$location","NetworkService",function(a,c,e,d){function k(a){console.log(a);e.path(a)}c.$on("$locationChangeStart",function(a,c,e){});d.registerListener({eventName:"locationChange",call:k});return{setPath:k,getPath:function(){return e.url()}}}]);angular.module("UserServiceModule",[]).factory("UserService",["$q","NetworkService","$rootScope","LocationService","SpecialPowerManagerService","ColorService","ENV",function(a,c,e,d,k,b,f){function m(b,e){v=a.defer();b=b.trim();4!==b.length?v.reject({ok:!1,message:"Gamecodes should be 4 characters long"}):c.send("playerJoinGame",{gamecode:b,username:u,playerClass:e})["catch"](function(a){v.reject({ok:!1,message:a.message})});return v.promise}var l="",r="",u="",v,p=[],g=0,n=0,h=2,q;q=b.getRedColors();
c.registerListener({eventName:"gamePlayerJoined",call:function(a){a.uID===l&&(a.joinSuccess?(0===a.team?(r="red-team",q=b.getRedColors()):1===a.team&&(r="blue-team",q=b.getBlueColors()),p=k.setupSpecials(a.specials),g=a.state,n=a.lane,h=a.heroClass,v.resolve(a)):v.reject(a))}});return{registerUserWithServer:function(b,e){var d=a.defer();b=b.trim();0===b.length?d.reject({ok:!1,message:"Please enter a name"}):20<b.length?d.reject({ok:!1,message:"Please use a shorter name"}):c.send("playerRegister",
{username:b}).then(function(a){u=b;l=a.uID;f.skipCode?m("abcd",e).then(function(a){0!==a.state&&1!==a.state||d.resolve({ok:!0,path:"/tutorial"})}):d.resolve({ok:!0,username:b,path:"/join"})})["catch"](function(a){d.reject({ok:!1,message:a.message})});return d.promise},attemptToJoinGame:m,setUserTeam:function(a){r=a},getUserTeam:function(){return r},getUsername:function(){return u},getUserID:function(){return l},setUserID:function(){return l},getTeamColor:function(){return q},getSpecialPowers:function(){0===
p.length&&(p=[{id:0,name:"Flame Ring Attack",type:"Attack",idea:"Melee",description:"Immediately cripple enemies close to you.",filename:"",cooldownTime:10,numberOfUpgrades:5,done:!0,enabled:!0,cssName:"special-Attack-Melee",image:"images/flame_red.png"},{id:3,name:"Defense Buff",type:"Buff",idea:"Defense",description:"Increase your defense to you can take more punishment.",filename:"",cooldownTime:2,numberOfUpgrades:5,done:!0,enabled:!0,cssName:"special-Buff-Defense",image:"images/health_buff_blue.png"},
{id:6,name:"Healing Ring Spell",type:"Heal",idea:"Self-and-close",description:"Immediately heal teammates close to you.",filename:"",cooldownTime:25,numberOfUpgrades:5,done:!0,enabled:!0,cssName:"special-Heal-Self-and-close",image:"images/heal_group_green.png"}]);return p},getGameState:function(){return g},getLane:function(){return n},getHeroClass:function(){return h}}}]);angular.module("myApp").service("TutorialService",function(){function a(a){for(var e=[],d=0;d<a.length;d++){var k=a[d],b={};b.text=k.name;b.image="../resources/"+k.image;b.description=k.description;e.push(b)}return e}return{makeTutorial:function(c,e,d){var k="red-team"===e?"viking":"cowboy",b="red-team"===e?"cowboy":"viking";e="red-team"===e?"COWBOY":"VIKING";var f="../../resources/images/tutorial/classes/"+k+"_",m="";a(d);0===c?(c="HUNTER",f+="hunter_sm.jpg",m="A ranged class that can do big damage from distance, but must avoid close range combat"):
1===c?(c="HITMAN",f+="hitman_sm.jpg",m="A stealthy class with faster speed and ways of getting past opposing players without being detected"):2===c?(c="HEALER",f+="healer_sm.jpg",m="A slow, heavy class with big attack and lots of health"):(c="HARDHAT",f+="hardhat_sm.jpg",m=" A support class who can heal, and buff stats, of themselves and their teammates");return[{tutIndex:0,tutType:"single",tutorialTitle:"You are a "+k.toUpperCase()+"!",tutorialText:"Destroy the "+e+"'S base to win the game",tutorialImage:{image:"../../resources/images/tutorial/backgrounds/"+
b+"_base.jpg",offset_x:"50%"},visible:!0},{tutIndex:1,tutType:"single",tutorialTitle:"You Auto-Attack enemies beside you",tutorialText:"Defeating enemy grunts and heros will make you stronger!",tutorialImage:{image:"../../resources/images/tutorial/backgrounds/"+k+"_grunt_battle.jpg",offset_x:"80%"},visible:!1},{tutIndex:2,tutType:"single",tutorialTitle:"Capture towers for your team",tutorialText:"Captured towers make your army bigger!",tutorialImage:{image:"../../resources/images/tutorial/backgrounds/tower.jpg",
offset_x:"80%"},visible:!1},{tutIndex:3,tutType:"single",tutorialTitle:"Help your team on the other side",tutorialText:"Travel through caves to appear on the opposite screen!",tutorialImage:{image:"/resources/images/tutorial/backgrounds/cave.jpg",offset_x:"80%"},visible:!1},{tutIndex:4,tutType:"single",tutorialTitle:"You are a "+c,tutorialText:m,tutorialImage:{image:f,offset_x:"50%"},visible:!1},{tutIndex:5,tutType:"multi",tutorialTitle:"Tutorial side not shown",miniLessons:a(d),tutorialImage:{image:"../../resources/images/tutorial/backgrounds/"+
k+"_battle_with_base_background.jpg",offset_x:"80%"},visible:!1}]}}});angular.module("myApp").factory("ClassService",["$http","$q",function(a,c){var e=[{name:"Hunter",hatImage:"/resources/images/hats/hunter_circle_small.png",powers:[0,1,2],powerDesc:[]},{name:"Hitman",hatImage:"/resources/images/hats/hitman_circle_small.png",description:"I am a hitman",powers:[4,10,9],powerDesc:[]},{name:"Healer",hatImage:"/resources/images/hats/healer_circle_small.png",powers:[3,5,6],powerDesc:[]},{name:"Hardhat",hatImage:"/resources/images/hats/hardhat_circle_small.png",powers:[0,
11,12],powerDesc:[]}];return{getClasses:function(){var d=c.defer();a.get("/resources/json/specialsList.json").then(function(a){var b=a.data.items;e.forEach(function(a){a.powers.forEach(function(c){for(var e=0;e<b.length;e++)b[e].id===c&&a.powerDesc.push(b[e])})});d.resolve(e)});return d.promise}}}]);(function(){function a(a,e,d,k,b,f,m){function l(b,e){var d=function(a){for(var b=0;b<h.length;b++)if(h[b].toastId===a)return h[b]}(b);d&&!d.deleting&&(d.deleting=!0,d.isOpened=!1,a.leave(d.el).then(function(){if(d.scope.options.onHidden)d.scope.options.onHidden(!!e,d);d.scope.$destroy();var a=h.indexOf(d);delete w[d.scope.message];h.splice(a,1);(a=f.maxOpened)&&h.length>=a&&h[a-1].open.resolve();h.length||(g.remove(),g=null,z=m.defer())}))}function r(a,b,c,d){angular.isObject(c)&&(d=c,c=null);return p({iconClass:a,
message:b,optionsOverride:d,title:c})}function u(){return angular.extend({},f)}function v(b){if(g)return z.promise;g=angular.element("<div></div>");g.attr("id",b.containerId);g.addClass(b.positionClass);g.css({"pointer-events":"auto"});b=angular.element(document.querySelector(b.target));if(!b||!b.length)throw"Target for toasts doesn't exist";a.enter(g,b).then(function(){z.resolve()});return z.promise}function p(d){function f(a,c,d){function e(b){if(d[b])return function(){d[b](a)}}d.allowHtml?(a.scope.allowHtml=
!0,a.scope.title=b.trustAsHtml(c.title),a.scope.message=b.trustAsHtml(c.message)):(a.scope.title=c.title,a.scope.message=c.message);a.scope.toastType=a.iconClass;a.scope.toastId=a.toastId;a.scope.extraData=d.extraData;a.scope.options={extendedTimeOut:d.extendedTimeOut,messageClass:d.messageClass,onHidden:d.onHidden,onShown:e("onShown"),onTap:e("onTap"),progressBar:d.progressBar,tapToDismiss:d.tapToDismiss,timeOut:d.timeOut,titleClass:d.titleClass,toastClass:d.toastClass};d.closeButton&&(a.scope.options.closeHtml=
d.closeHtml)}function p(){function a(b){for(var c="containerId iconClasses maxOpened newestOnTop positionClass preventDuplicates preventOpenDuplicates templates".split(" "),d=0,e=c.length;d<e;d++)delete b[c[d]];return b}var b={toastId:n++,isOpened:!1,scope:k.$new(),open:m.defer()};b.iconClass=d.iconClass;d.optionsOverride&&(angular.extend(t,a(d.optionsOverride)),b.iconClass=d.optionsOverride.iconClass||b.iconClass);f(b,d,t);b.el=r(b.scope);return b}function r(a){var b=angular.element("<div toast></div>");
return e.get("$compile")(b)(a)}var t=u();if(!function(){var a=t.preventOpenDuplicates&&w[d.message];if(t.preventDuplicates&&d.message===q||a)return!0;q=d.message;w[d.message]=!0;return!1}()){var x=p();h.push(x);if(t.autoDismiss&&t.maxOpened&&h.length>t.maxOpened)for(var z=h.slice(0,h.length-t.maxOpened),E=0,D=z.length;E<D;E++)l(z[E].toastId);(t.maxOpened&&h.length<=t.maxOpened||!t.maxOpened)&&x.open.resolve();x.open.promise.then(function(){v(t).then(function(){x.isOpened=!0;if(t.newestOnTop)a.enter(x.el,
g).then(function(){x.scope.init()});else{var b=g[0].lastChild?angular.element(g[0].lastChild):null;a.enter(x.el,g,b).then(function(){x.scope.init()})}})});return x}}var g,n=0,h=[],q="",w={},z=m.defer();return{active:function(){return h.length},clear:function(a){if(1!==arguments.length||a)if(a)l(a.toastId);else for(var b=0;b<h.length;b++)l(h[b].toastId)},error:function(a,b,c){var d=u().iconClasses.error;return r(d,a,b,c)},info:function(a,b,c){var d=u().iconClasses.info;return r(d,a,b,c)},remove:l,
success:function(a,b,c){var d=u().iconClasses.success;return r(d,a,b,c)},warning:function(a,b,c){var d=u().iconClasses.warning;return r(d,a,b,c)}}}angular.module("toastr",[]).factory("toastr",a);a.$inject="$animate $injector $document $rootScope $sce toastrConfig $q".split(" ")})();
(function(){angular.module("toastr").constant("toastrConfig",{allowHtml:!1,autoDismiss:!1,closeButton:!1,closeHtml:"<button>&times;</button>",containerId:"toast-container",extendedTimeOut:1E3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},maxOpened:0,messageClass:"toast-message",newestOnTop:!0,onHidden:null,onShown:null,onTap:null,positionClass:"toast-top-right",preventDuplicates:!1,preventOpenDuplicates:!1,progressBar:!1,tapToDismiss:!0,target:"body",
templates:{toast:"directives/toast/toast.html",progressbar:"directives/progressbar/progressbar.html"},timeOut:5E3,titleClass:"toast-title",toastClass:"toast"})})();
(function(){function a(a){return{replace:!0,require:"^toast",templateUrl:function(){return a.templates.progressbar},link:function(a,c,k,b){function f(){var a=(r-(new Date).getTime())/l*100;c.css("width",a+"%")}var m,l,r;b.progressBar=a;a.start=function(a){m&&clearInterval(m);l=parseFloat(a);r=(new Date).getTime()+l;m=setInterval(f,10)};a.stop=function(){m&&clearInterval(m)};a.$on("$destroy",function(){clearInterval(m)})}}}angular.module("toastr").directive("progressBar",a);a.$inject=["toastrConfig"]})();
(function(){angular.module("toastr").controller("ToastController",function(){this.progressBar=null;this.startProgressBar=function(a){this.progressBar&&this.progressBar.start(a)};this.stopProgressBar=function(){this.progressBar&&this.progressBar.stop()}})})();
(function(){function a(a,e,d,k){return{replace:!0,templateUrl:function(){return d.templates.toast},controller:"ToastController",link:function(b,d,m,l){function r(a){l.startProgressBar(a);return e(function(){l.stopProgressBar();k.remove(b.toastId)},a,1)}var u;b.toastClass=b.options.toastClass;b.titleClass=b.options.titleClass;b.messageClass=b.options.messageClass;b.progressBar=b.options.progressBar;if(b.options.closeHtml){m=angular.element(b.options.closeHtml);var v=a.get("$compile");m.addClass("toast-close-button");
m.attr("ng-click","close(true, $event)");v(m)(b);d.prepend(m)}b.init=function(){b.options.timeOut&&(u=r(b.options.timeOut));if(b.options.onShown)b.options.onShown()};d.on("mouseenter",function(){b.progressBar=!1;l.stopProgressBar();u&&e.cancel(u)});b.tapToast=function(){if(angular.isFunction(b.options.onTap))b.options.onTap();b.options.tapToDismiss&&b.close(!0)};b.close=function(a,c){c&&angular.isFunction(c.stopPropagation)&&c.stopPropagation();k.remove(b.toastId,a)};d.on("mouseleave",function(){if(0!==
b.options.timeOut||0!==b.options.extendedTimeOut)b.$apply(function(){b.progressBar=b.options.progressBar}),u=r(b.options.extendedTimeOut)})}}}angular.module("toastr").directive("toast",a);a.$inject=["$injector","$interval","toastrConfig","toastr"]})();angular.module("toastr").run(["$templateCache",function(a){a.put("directives/progressbar/progressbar.html",'<div class="toast-progress"></div>\n');a.put("directives/toast/toast.html",'<div class="{{toastClass}} {{toastType}}" ng-click="tapToast()">\n  <div ng-switch on="allowHtml">\n    <div ng-switch-default ng-if="title" class="{{titleClass}}" aria-label="{{title}}">{{title}}</div>\n    <div ng-switch-default class="{{messageClass}}" aria-label="{{message}}">{{message}}</div>\n    <div ng-switch-when="true" ng-if="title" class="{{titleClass}}" ng-bind-html="title"></div>\n    <div ng-switch-when="true" class="{{messageClass}}" ng-bind-html="message"></div>\n  </div>\n  <progress-bar ng-if="progressBar"></progress-bar>\n</div>\n')}]);/*
 MIT License, http://www.opensource.org/licenses/MIT
*/
(function(a,c,e){var d=c.isDefined,k=c.isUndefined,b=c.isNumber,f=c.isObject,m=c.isArray,l=c.extend,r=c.toJson;c.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls";this.storageType="localStorage";this.cookie={expiry:30,path:"/"};this.notify={setItem:!0,removeItem:!1};this.setPrefix=function(a){this.prefix=a;return this};this.setStorageType=function(a){this.storageType=a;return this};this.setStorageCookie=function(a,b){this.cookie.expiry=a;this.cookie.path=b;
return this};this.setStorageCookieDomain=function(a){this.cookie.domain=a;return this};this.setNotify=function(a,b){this.notify={setItem:a,removeItem:b};return this};this.$get=["$rootScope","$window","$document","$parse",function(a,c,e,g){var n=this,h=n.prefix,q=n.cookie,w=n.notify,z=n.storageType,B;e?e[0]&&(e=e[0]):e=document;"."!==h.substr(-1)&&(h=h?h+".":"");var A=function(){try{var b=z in c&&null!==c[z],d=h+("__"+Math.round(1E7*Math.random()));b&&(B=c[z],B.setItem(d,""),B.removeItem(d));return b}catch(e){return z=
"cookie",a.$broadcast("LocalStorageModule.notification.error",e.message),!1}}(),H=function(b,c){c=k(c)?null:r(c);if(!A||"cookie"===n.storageType)return A||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),w.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:"cookie"}),C(b,c);try{B&&B.setItem(h+b,c),w.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:n.storageType})}catch(d){return a.$broadcast("LocalStorageModule.notification.error",
d.message),C(b,c)}return!0},G=function(b){if(!A||"cookie"===n.storageType)return A||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),E(b);b=B?B.getItem(h+b):null;if(!b||"null"===b)return null;try{return JSON.parse(b)}catch(c){return b}},t=function(){var b,c;for(b=0;b<arguments.length;b++)if(c=arguments[b],A&&"cookie"!==n.storageType)try{B.removeItem(h+c),w.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:n.storageType})}catch(d){a.$broadcast("LocalStorageModule.notification.error",
d.message),D(c)}else A||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),w.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:"cookie"}),D(c)},x;try{x=c.navigator.cookieEnabled||"cookie"in e&&(0<e.cookie.length||-1<(e.cookie="test").indexOf.call(e.cookie,"test"))}catch(I){a.$broadcast("LocalStorageModule.notification.error",I.message),x=!1}var C=function(c,d,g){if(k(d))return!1;if(m(d)||f(d))d=r(d);if(!x)return a.$broadcast("LocalStorageModule.notification.error",
"COOKIES_NOT_SUPPORTED"),!1;try{var y="",l=new Date,n="";null===d?(l.setTime(l.getTime()+-864E5),y="; expires="+l.toGMTString(),d=""):b(g)&&0!==g?(l.setTime(l.getTime()+864E5*g),y="; expires="+l.toGMTString()):0!==q.expiry&&(l.setTime(l.getTime()+864E5*q.expiry),y="; expires="+l.toGMTString());if(c){var t="; path="+q.path;q.domain&&(n="; domain="+q.domain);e.cookie=h+c+"="+encodeURIComponent(d)+y+t+n}}catch(v){return a.$broadcast("LocalStorageModule.notification.error",v.message),!1}return!0},E=function(b){if(!x)return a.$broadcast("LocalStorageModule.notification.error",
"COOKIES_NOT_SUPPORTED"),!1;for(var c=e.cookie&&e.cookie.split(";")||[],d=0;d<c.length;d++){for(var f=c[d];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(h+b+"=")){b=decodeURIComponent(f.substring(h.length+b.length+1,f.length));try{return JSON.parse(b)}catch(g){return b}}}return null},D=function(a){C(a,null)},F=function(){for(var a=null,b=h.length,c=e.cookie.split(";"),d=0;d<c.length;d++){for(a=c[d];" "===a.charAt(0);)a=a.substring(1,a.length);a=a.substring(b,a.indexOf("="));D(a)}};
return{isSupported:A,getStorageType:function(){return z},set:H,add:H,get:G,keys:function(){if(!A)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var b=h.length,c=[],d;for(d in B)if(d.substr(0,b)===h)try{c.push(d.substr(b))}catch(e){return a.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return c},remove:t,clearAll:function(b){var c=h?new RegExp("^"+h):RegExp();b=b?new RegExp(b):RegExp();if(!A||"cookie"===n.storageType)return A||
a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),F();var d=h.length,e;for(e in B)if(c.test(e)&&b.test(e.substr(d)))try{t(e.substr(d))}catch(f){return a.$broadcast("LocalStorageModule.notification.error",f.message),F()}return!0},bind:function(a,b,c,e){e=e||b;var h=G(e);null===h&&d(c)?h=c:f(h)&&f(c)&&(h=l(c,h));g(b).assign(a,h);return a.$watch(b,function(a){H(e,a)},f(a[b]))},deriveKey:function(a){return h+a},length:function(){for(var a=0,b=c[z],d=0;d<b.length;d++)0===
b.key(d).indexOf(h)&&a++;return a},cookie:{isSupported:x,set:C,add:C,get:E,remove:D,clearAll:F}}}]})})(window,window.angular);
